anamul
======

MG fit, FFT fit, Detector response fit for SiPM spes and DCR

Programs and usage
==================
. is anamul folder, 
to use the python script, python-numpy(1.6.1), python-scipy(0.9.0), python-matplotlib(1.1.1) must be installed. 

./bin/getfit <DIR> <n-file>
    <DIR> is the folder contains spes-[i].root and spes-[i]-dcr.root files
    [i] in the range of  [0,<n-files>], files not exist will be ignored. 
    The program do multi-gaussian and FFT fit on spes-[i].root files, get DCR and XT from spes-[i]-dcr.root files. 
    Make sure the same voltage applied to spes-[i].root and spes-[i]-dcr.root file, otherwise DCR is not correctly calculated. 
    All output parameters are in <DIR>/spes.log

./bin/getfitsingle <path/filename> [ped] [gain] [npks]
    Run the same fit on single root file and leave the session in ROOT afterwards. An entry is printed in the end, can be used to substitute the entry in <DIR>/spes.log directly.
    [ped] [gain] (must be given together, in qdcch) will be used instead of finding peaks. 
    [npks] tells the program how many peaks after 0pe are expected in the spes histogram.

./bin/getdcr <DIR> <n-file> <fitpar0> <fitpar1> <effgate>
    Get DCR from spes-<i>-dcr.root files in <DIR>, use this in case the dcr are measured seperately.
    The program determine 0.5thr from the linear dependance of gain on Vbias.
    <fitpar0> <fitpar1> are fit parameters in Gain = <fitpar0>+Vbias*<fitpar1>, all in qdcch unit. Mind that Vbias may be negtive.
    <effgate> is the effective QDC gate in DCR measurement.

./pythonfit/SiPMSpesFit.py <DIR>
    spes.log generated by getfit must exist in <DIR>, the program will then apply detector response fit on the root files. 
    Output parameters are written in <DIR>/pyspes.log
    fitted histograms are printed in <DIR>/out.pdf

./pythonfit/SiPMPlot.py <DIR>
    plot the results, comment out the functions in the file.